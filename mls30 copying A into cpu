%%cuda --name inv.cu
#include<stdio.h>
#include<math.h>
// This function is to find the determinant value of matrix . . .
float determin(float matrix[3][3], int k)
{
    float deter=0.0, z=1.0, mt[3][3];
    int a, b, c, x, y;
    if(k==1)
    {
        return(matrix[0][0]);
    }
    else
    {
        deter=0;
        for(a=0;a<k;++a)
        {
            x=0;
            y=0;
            for(b=0;b<k;++b)
            {
                for(c=0;c<k;++c)
                {
                    mt[b][c]=0;
                    if((b != 0) && (c != a))
                    {
                        mt[x][y]=matrix[b][c];
                        if(y<(k-2))
                        {
                            y++;
                        }
                        else
                        {
                            y=0;
                            x++;
                        }
                    }
                }
           }
           deter=deter + z * (matrix[0][a] * determin(mt,k-1));
           z=-1 * z;
        }
           }
           return(deter);
    }
// This function is to transpose of matrix . . .

void trans(float matr[3][3], float m1[3][3], int r,float invA[3][3])
{
    float inv_matrix[3][3], tran[3][3], d;
    int a,b;
    for(a=0;a<r;++a)
    {
        for(b=0;b<r;++b)
        {
            tran[a][b]=m1[b][a];
        }
    }
    d=determin(matr, r);
    for(a=0;a<r;++a)
    {
        for(b=0;b<r;++b)
        {
            inv_matrix[a][b]=tran[a][b] / d;
            invA[a][b]=inv_matrix[a][b];
        }
    }
          printf("The Inverse of matrix of  3 x 3 matrix is\n");
          for(a=0;a<r;++a)
          {
             for(b=0;b<r;++b)
             {
                 printf("%f ", inv_matrix[a][b]);
             }
          printf("\n");
          }
}

// This function is to find cofactors of matrix . . .
void cofac(float comatr[3][3], int f,float invA[3][3])
{
    float matr[3][3], cofact[3][3];
    int a, b, c, d, x, y;
    for(c=0; c<f; ++c)
    {
      
      for(d=0; d<f; ++d)
      {
          x=0;
          y=0;
          for(a=0;a<f; ++a)
          {
              for(b=0; b<f; ++b)
              {
                  if(a != c && b != d)
                  {
                      matr[x][y]=comatr[a][b];
                      if(y<(f-2))
                      {
                          y++;
                      }
                      else
                      {
                          y=0;
                          x++;
                      }
                  }
              }
          }
          cofact[c][d] = pow(-1,c + d) * determin(matr,f-1);
      }
    }
    trans(comatr, cofact, f,invA);
}

int main()
{
    float matrix[3][3]={{12 ,3 ,-1} ,{11, 24, 0.81}, {11, 6, 1}},invA[3][3], deter;
    int i, j;
    deter = determin(matrix, 3);
    printf("The Determinant of the Matrix is : %f\n", deter);
    if(deter == 0)
    {
        printf("Inverse of Matrix is not possible for the matrices having 0 Determinant value !!\n");
    }
    else
    {
         cofac(matrix, 3,invA);
    }    
    printf("\nin main func\n");
    for(i=0;i<3;++i)
    {
        for(j=0;j<3;++j)
        {
            printf("%f ",invA[i][j]);
        }
     printf("\n");
    }         
  return 0;
}
